package clone

import (
	"reflect"
	"testing"
)

type inner struct {
	Name   string
	Values []string
}

type outer struct {
	A int
	B float32
	C string
	D []string
	E map[string]*inner
}

func TestClone(t *testing.T) {
	data := &outer{
		A: 1,
		B: 2.3,
		C: "zap",
		D: []string{"yow", "xoom"},
		E: map[string]*inner{
			"wow":    &inner{"veep", []string{"umph", "toot"}},
			"sheesh": &inner{"rawr", []string{"qqq", "poof"}},
		},
	}

	var cloned *outer

	Clone(data, &cloned)
	if !reflect.DeepEqual(data, cloned) {
		t.Errorf("data not cloned correctly:\n   data:   %#v\n   cloned: %#v\n\n", data, cloned)
	}
}

func TestDoClone(t *testing.T) {
	data := &outer{
		A: 1,
		B: 2.3,
		C: "zap",
		D: []string{"yow", "xoom"},
		E: map[string]*inner{
			"wow":    &inner{"veep", []string{"umph", "toot"}},
			"sheesh": &inner{"rawr", []string{"qqq", "poof"}},
		},
	}

	cloned := DoClone(data).(*outer)

	if !reflect.DeepEqual(data, cloned) {
		t.Errorf("data not cloned correctly:\n   data:   %#v\n   cloned: %#v\n\n", data, cloned)
	}
}
